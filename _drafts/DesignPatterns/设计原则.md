
### 设计原则

#### 设计原则：里氏代换原则（LSP）

任何基类出现的地方，子类一定可以出现。里氏代换原则是对开闭原则(OCP）的补充。一般而言，违反里氏代换原则，则也违背开闭原则，但是，反过来并不一定成立。

里氏代换原则说的是一个软件实体如果使用的是一个基类的话，那么一定适用于其子类，而且它根本不能觉察出基类对象和子类对象的区别。

应当尽量从抽象类继承，而不从具体类继承。


#### 设计原则：开闭原则（OCP）

一个软件实体应当对扩展开放，对修改关闭。

实现OCP的关键是抽象化，并且从抽象化导出具体化实现。

很多情况下，无法百分百实现OCP，但是如果朝着这个方向努力，能够取得部分的成功，能够显著的改善一个系统。

#### 设计原则：依赖倒置原则（DIP）

依赖倒置原则讲的是要依赖于抽象，而不要依赖实现（要面向接口编程，而不要面向实现编程）。它与开闭原则（OCP）的关系是目标和手段的关系，要实现开闭原则，就需要坚持依赖倒置原则，违反依赖倒置原则，就不可能达到开闭原则的要求。

在面向对象的系统里，两个类之间存在三种不同的耦合关系：

- 零耦合（Nil Coupling）：如果两个类没有耦合，则为零耦合
- 具体耦合（Concrete Coupling）：发生在两个具体的类之间，经由一个类对另一个类的直接引用造成。
- 抽象耦合（Abstract Coupling）：抽象耦合发生在一个具体类和一个抽象类之间，使这两个必然发生关系的类之间存在着最大的灵活性。

所谓的依赖倒置，就是说客户端要依赖于抽象耦合。DIP强调的是系统内实体之间关系的灵活性。

DIP是OO设计的核心原则，设计模式的研究和应用是以依赖倒置原则为指导原则的。

#### 设计原则：接口隔离原则（ISP）

接口隔离原则讲的是，应当为客户端提供尽可能小的单独的接口，而不是提供大的总接口。ISP所讲的是使用多个专门的接口比使用单一的总接口要好。从一个客户类来说，一个类对另一个类的依赖性应当是建立在最小的接口上的。

过于臃肿的接口是对接口的污染，由于每一个接口都对应一个角色，实现一个接口的对象，在他的整个生命周期中都扮演这个角色，因此，将角色分清楚就是系统设计的一个重要的工作。一个符合逻辑的推断，不应当将几个不同的角色都交给同一个接口，而应当交给不同的接口。

一些没有经验的设计师往往希望节省接口的数量，因此，将一些看上去差不多的接口合并，一些人将此看为是对代码优化的一部分，这是错误的。准确恰当的划分角色以及角色使用的接口，是面向对象设计的一个重要组成部分。故此将没有关系的接口合并在一起，形成一个臃肿的大接口，是对角色和接口的污染。


#### 设计原则：合成/聚合复用原则（CARP）

CARP讲的是要尽量使用合成/聚合，而不是使用继承达到复用的目的。合成/聚合复用原则和里氏代换原则（LSP）是对开闭原则（OCP）的具体步骤的规范，LSP要求设计者优先考虑CARP关系，而后者则要求使用继承关系时，必须确定这个关系是符合一定条件的。

聚合用来表示“拥有”或者整体与部分的关系，而合成则表示一种强得多的“拥有”关系。在一个合成关系中，部分和整体的生命周期是一样的。一个合成的新的对象完全拥有其组成部分的支配权，包括他们的创建和湮灭等，使用程序设计语言的术语来讲，组合而成的新对象对组成部分的内存分配、内存释放有绝对的责任。

要理解为什么使用CARP，需要先理解IS-A和HAS-A的关系，如果两个类的关系是IS-A，则可以使用继承关系，如果是HAS-A，则使用合成/聚合。

- IS-A 代表一个类是另一个类的一种
- HAS-A 则代表一个类是另一个类的一个角色，而不是另一个类的一个特殊种类。

里氏代换原则（LSP）是继承复用的基石，只有当每一个类S在任何情况下都是一种B类的时候，才可以将S设计为B的子类。只有两个类满足了里氏代换原则，才可能是IS-A的关系。


#### 设计原则：迪米特法则（LoD）

迪米特法则也叫做最小值是原则（LKP），讲的是一个软件实体应当尽可能少的与其它实体发生相互作用（对其他对象尽可能少的了解）。

在应用LoD的过程中，要注意以下几点：

- 在类的划分上，应当创建弱耦合的类
- 在类的设计上，应当尽量降低成员的访问权限
- 在类的设计上，只要有可能，一个类应当设计成不变类。当涉及到一个类的时候，都首先考虑这个类的状态是否需要改变，即使一个类必须是可变类，在给他的属性赋值的时候，也要保持吝啬的态度。除非真的需要，否则不要为一个属性设置赋值方法
- 在对其它类的引用上，一个对象对其它对象的引用应当降到最低

谨慎使用Serializable串行化，如果使用了的话，类内部的将不能进行修改。为了防止串行化和并行化出错，软件提供商一般一旦将一个类设置成为Serializable的话，就不能再在新的版本中修改这个类的内部结构，包括private的方法和字段。